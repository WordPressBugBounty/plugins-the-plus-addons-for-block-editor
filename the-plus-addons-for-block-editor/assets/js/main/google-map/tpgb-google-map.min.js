document.addEventListener("DOMContentLoaded",function(){tpgbInitMap()});function tpgbInitMap(){if("undefined"==typeof google||!google.maps){console.warn("Google Maps is not loaded yet.");return}document.querySelectorAll(".tpgb-adv-map").forEach(function(e){var t=e.getAttribute("data-id"),n=JSON.parse(e.getAttribute("data-map-settings")),o=null,a=null,d=null,i=null;if(!e.classList.contains("map-loaded")){var s=[],r=function(){console.log("data = ",n),a=new google.maps.LatLngBounds,o=new google.maps.Map(document.getElementById(t),n.options),d=new google.maps.InfoWindow,o.setTilt(45),google.maps.event.addListener(d,"domready",function(){var e=document.querySelector(".gm-style-iw");e.previousElementSibling,e.parentElement.classList.add("marker-icon"),e.nextElementSibling.style.display="none",e.classList.add("marker-title")});for(let e=0;e<n.places.length;e++){let s=n.places[e];if(console.log("data.places[i].latOrAddr =",s.latOrAddr),"latitude"===s.latOrAddr){i=new google.maps.LatLng(s.latitude,s.longitude),a.extend(i);let r={position:i,map:o,title:s.address||""};s.pin_icon&&(r.icon=s.pin_icon);let l=new google.maps.Marker(r);google.maps.event.addListener(l,"click",function(e,t){return function(){s.address?.length>1&&(d.setContent(`<div class="gmap_info_content"><p>${s.address}</p></div>`),d.open(o,e))}}(l,e)),o.fitBounds(a)}if("address"===s.latOrAddr&&s.addr){console.log("place = ",s);let p=new google.maps.Geocoder,c=s.addr,g=s.address||s.addr,u=s.pin_icon||"";console.log(`[Geocode] Starting geocoding for: ${c}`),p.geocode({address:c},function(t,n){if(console.log(`[Geocode] Status for "${c}":`,n),n===google.maps.GeocoderStatus.OK&&t[0]){let i=t[0].geometry.location;console.log("[Geocode] Geocoded position:",i.toString()),a.extend(i);let s={position:i,map:o,title:g||""};u&&(s.icon=u);let r=new google.maps.Marker(s);console.log(`[Geocode] Marker created for: "${g}"`),google.maps.event.addListener(r,"click",function(e,t){return function(){console.log(`[Marker Click] for: "${g}"`);let t=`<div class="gmap_info_content"><p>${g}</p></div>`;d.setContent(t),console.log(`[InfoWindow] Content: ${t}`),d.open(o,e)}}(r,e)),o.fitBounds(a),console.log(`[Map] Bounds fitted for: "${g}"`)}else console.warn(`[Geocode] Failed for "${g}" | Status: ${n}`)})}}var f=google.maps.event.addListener(o,"idle",function(){this.setZoom(n.options.zoom),google.maps.event.removeListener(f)});google.maps.event.trigger(o,"resize"),o.setCenter(i)};s.push(r),function(){for(var e=0,t=s.length;e<t;e++)s[e]()}(),e.classList.add("map-loaded")}})}